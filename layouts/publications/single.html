{{ define "main" }}
<article class="publication-detail">
  <!-- Hero Section -->
  <header class="publication-hero">
    <div class="container">
      <h1 class="publication-hero__title">{{ .Title }}</h1>
      
      <div class="publication-hero__authors">
        {{ $teamMembers := site.GetPage "/team" }}
        {{ $authors := split .Params.authors ", " }}
        {{ range $i, $author := $authors }}
          {{ $authorSlug := $author | urlize }}
          {{ $isMember := false }}
          {{ $memberPage := "" }}
          {{ range $teamMembers.Pages }}
            {{ if in (lower .Title) (lower $author) }}
              {{ $isMember = true }}
              {{ $memberPage = .Permalink }}
            {{ end }}
          {{ end }}
          {{ if $isMember }}<a href="{{ $memberPage }}" class="publication-hero__author publication-hero__author--team">{{ $author }}</a>{{ else }}<span class="publication-hero__author">{{ $author }}</span>{{ end }}{{ if ne $i (sub (len $authors) 1) }}, {{ end }}
        {{ end }}
      </div>
      
      <div class="publication-hero__venue">
        {{ .Params.venue }}{{ with .Params.year }} {{ . }}{{ end }}
      </div>
      
      <div class="publication-hero__links">
        {{ with .Params.arxiv }}
        <a href="{{ . }}" target="_blank" rel="noopener" class="btn btn--outline">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
          arXiv
        </a>
        {{ end }}
        {{ with .Params.pdf }}
        <a href="{{ . }}" target="_blank" rel="noopener" class="btn btn--outline">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line></svg>
          PDF
        </a>
        {{ end }}
        {{ with .Params.proceedings }}
        <a href="{{ . }}" target="_blank" rel="noopener" class="btn btn--outline">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
          Proceedings
        </a>
        {{ end }}
        {{ with .Params.code }}
        <a href="{{ . }}" target="_blank" rel="noopener" class="btn btn--outline">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>
          Code
        </a>
        {{ end }}
        {{ with .Params.video }}
        <a href="{{ . }}" target="_blank" rel="noopener" class="btn btn--outline">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="23 7 16 12 23 17 23 7"></polygon><rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect></svg>
          Video
        </a>
        {{ end }}
      </div>
    </div>
  </header>
  
  <!-- Hero Image -->
  {{ with .Params.hero_image }}
  <div class="publication-hero__image">
    <div class="container">
      <img src="{{ . | relURL }}" alt="{{ $.Title }} - Figure">
    </div>
  </div>
  {{ end }}
  
  <div class="container">
    <!-- TL;DR Summary -->
    {{ with .Params.summary }}
    <section class="publication-section">
      <h2 class="publication-section__title">TL;DR</h2>
      <p class="publication-tldr">{{ . }}</p>
    </section>
    {{ end }}
    
    <!-- Abstract -->
    {{ with .Params.abstract }}
    <section class="publication-section">
      <h2 class="publication-section__title">Abstract</h2>
      <div class="publication-abstract">
        {{ . | markdownify }}
      </div>
    </section>
    {{ end }}
    
    <!-- Main Content (if any) -->
    {{ with .Content }}
    <section class="publication-section">
      {{ . }}
    </section>
    {{ end }}
    
    <!-- BibTeX -->
    {{ with .Params.bibtex }}
    <section class="publication-section">
      <h2 class="publication-section__title">Citation</h2>
      <div class="publication-bibtex">
        <pre><code>{{ . }}</code></pre>
        <button class="btn btn--small publication-bibtex__copy" onclick="navigator.clipboard.writeText(this.previousElementSibling.textContent); this.textContent='Copied!'; setTimeout(() => this.textContent='Copy BibTeX', 2000);">Copy BibTeX</button>
      </div>
    </section>
    {{ end }}
  </div>
</article>
{{ end }}
